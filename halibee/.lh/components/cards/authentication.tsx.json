{
    "sourceFile": "components/cards/authentication.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1638740101015,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1638740114147,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,10 +1,10 @@\n import { createUserWithEmailAndPassword, sendEmailVerification, sendPasswordResetEmail, signInWithEmailAndPassword, updateProfile } from \"firebase/auth\";\r\n import { useRouter } from \"next/dist/client/router\";\r\n import { useState } from \"react\";\r\n-import { auth, firestore, functions } from \"../modules/firebase/initialiseFirebase\";\r\n import { signOut } from \"@firebase/auth\"\r\n import Swal from \"sweetalert2\";\r\n+import { auth } from \"../../modules/firebase/initialiseFirebase\";\r\n \r\n \r\n export default function Authentication() {\r\n \r\n"
                },
                {
                    "date": 1638740125467,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import { useState } from \"react\";\r\n import { signOut } from \"@firebase/auth\"\r\n import Swal from \"sweetalert2\";\r\n import { auth } from \"../../modules/firebase/initialiseFirebase\";\r\n+import { Toast } from \"../../modules/utilities/utilities\";\r\n \r\n \r\n export default function Authentication() {\r\n \r\n"
                },
                {
                    "date": 1638740704699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,9 +144,8 @@\n \r\n \r\n     return (\r\n \r\n-        <div className=\"w-full h-screen font-sans bg-cover\">\r\n             <div className=\"container flex items-center justify-center flex-1 h-full mx-auto\">\r\n                 <div className=\"w-full max-w-lg\">\r\n                     <div className=\"leading-loose\">\r\n                         <div className=\"max-w-sm p-10 m-auto bg-primary dark:bg-darkMode bg-opacity-90 rounded shadow-xl\">\r\n"
                }
            ],
            "date": 1638740101015,
            "name": "Commit-0",
            "content": "import { createUserWithEmailAndPassword, sendEmailVerification, sendPasswordResetEmail, signInWithEmailAndPassword, updateProfile } from \"firebase/auth\";\r\nimport { useRouter } from \"next/dist/client/router\";\r\nimport { useState } from \"react\";\r\nimport { auth, firestore, functions } from \"../modules/firebase/initialiseFirebase\";\r\nimport { signOut } from \"@firebase/auth\"\r\nimport Swal from \"sweetalert2\";\r\n\r\n\r\nexport default function Authentication() {\r\n\r\n    const [newUser, setNewUser] = useState(false)\r\n    const [forgotPassword, setForgotPassword] = useState(false)\r\n    const [username, setUsername] = useState(\"\");\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [repeatPassword, setRepeatPassword] = useState(\"\");\r\n    const router = useRouter()\r\n\r\n    const logout = () => {\r\n        signOut(auth)\r\n        router.push('/')\r\n    }\r\n\r\n    const createAccount = async () => {\r\n        try {\r\n            if (password === repeatPassword) {\r\n\r\n                await createUserWithEmailAndPassword(auth, email, password)\r\n                    .then(function (result) {\r\n                        return updateProfile(result.user, {\r\n                            displayName: username,\r\n                            photoURL: \"https://firebasestorage.googleapis.com/v0/b/halibee.appspot.com/o/images%2FdefaultImages%2Fprofile_placeholder.png?alt=media&token=38390ea9-171a-49e9-9ee3-d585b08686c6\"\r\n                        })\r\n                    })\r\n                    .then(function () {\r\n                        const user = auth.currentUser\r\n                        sendEmailVerification(user)\r\n                            .then(() => {\r\n                                Swal.fire(\r\n                                    {\r\n                                        icon: 'success',\r\n                                        title: 'Welcome!',\r\n                                        text: 'Please verify your email through the link sent to you!',\r\n                                        showCloseButton: true,\r\n                                        showConfirmButton: false\r\n                                    }\r\n                                )\r\n                                logout()\r\n                            })\r\n                    })\r\n                router.push('/')\r\n            } else {\r\n                Swal.fire(\r\n                    {\r\n                        title: 'Sign Up Error',\r\n                        text: 'Please check if your passwords match.',\r\n                        showCloseButton: true,\r\n                        showConfirmButton: false,\r\n                        icon: 'error'\r\n                    }\r\n                )\r\n            }\r\n        } catch (error) {\r\n            Swal.fire({\r\n                title: 'Error',\r\n                text: error.message,\r\n                showCloseButton: true,\r\n                icon: 'error',\r\n                showConfirmButton: false\r\n            });\r\n        }\r\n    }\r\n\r\n    const signIn = async () => {\r\n        try {\r\n            await signInWithEmailAndPassword(auth, email, password)\r\n            \r\n            if (!auth.currentUser.emailVerified) {\r\n                sendEmailVerification(auth.currentUser)\r\n                    .then(() => {\r\n                        Toast.fire(\r\n                            {\r\n                                title: 'Welcome!',\r\n                                icon: 'success',\r\n                                text: 'Please verify your email through the link sent to you!',\r\n                                showCloseButton: false,\r\n                                showConfirmButton: false\r\n                            }\r\n                        )\r\n                        logout()\r\n                    })\r\n            }\r\n            else {\r\n                Toast.fire(\r\n                    {\r\n                        title: 'Welcome!',\r\n                        showCloseButton: false,\r\n                        showConfirmButton: false,\r\n                        icon: 'success'\r\n                    }\r\n                )\r\n                \r\n                }\r\n            router.push('/')\r\n        } catch (error) {\r\n            console.log(error);\r\n            Swal.fire(\r\n                {\r\n                    title: 'Error',\r\n                    text: error.message,\r\n                    showCloseButton: true,\r\n                    showConfirmButton: false,\r\n                    icon: 'error'\r\n                }\r\n            )\r\n        }\r\n    }\r\n\r\n    const resetPassword = async (email) => {\r\n        try {\r\n            await sendPasswordResetEmail(auth, email);\r\n            Swal.fire(\r\n                {\r\n                    title: 'Sent',\r\n                    text: \"Please check your email to reset your password.\",\r\n                    showCloseButton: true,\r\n                    showConfirmButton: false,\r\n                    icon: 'info'\r\n                }\r\n            )\r\n        } catch (error) {\r\n            Swal.fire(\r\n                {\r\n                    title: 'Error',\r\n                    text: error.message,\r\n                    showCloseButton: true,\r\n                    showConfirmButton: false,\r\n                    icon: 'error'\r\n                }\r\n            )\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n\r\n        <div className=\"w-full h-screen font-sans bg-cover\">\r\n            <div className=\"container flex items-center justify-center flex-1 h-full mx-auto\">\r\n                <div className=\"w-full max-w-lg\">\r\n                    <div className=\"leading-loose\">\r\n                        <div className=\"max-w-sm p-10 m-auto bg-primary dark:bg-darkMode bg-opacity-90 rounded shadow-xl\">\r\n                            <p className=\"mb-8 text-2xl font-light text-center text-white\">\r\n                                Welcome!\r\n                            </p>\r\n                            {newUser &&\r\n                                <div className=\"mb-2\">\r\n                                    <div className=\" relative \">\r\n                                        <input type=\"text\"\r\n                                            placeholder=\"Username\"\r\n                                            value={username}\r\n                                            onChange={(e) => setUsername(e.target.value)}\r\n                                            className=\" rounded-lg border-transparent flex-1 appearance-none border border-gray-300 w-full py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            }\r\n                            <div className=\"mb-2\">\r\n                                <div className=\" relative \">\r\n                                    <input type=\"email\"\r\n                                        placeholder=\"Email\"\r\n                                        value={email}\r\n                                        onChange={(e) => setEmail(e.target.value)}\r\n                                        className=\" rounded-lg border-transparent flex-1 appearance-none border border-gray-300 w-full py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            {!forgotPassword &&\r\n                                <div className=\"mb-2\">\r\n                                    <div className=\" relative \">\r\n                                        <input type=\"password\"\r\n                                            value={password}\r\n                                            onChange={(e) => setPassword(e.target.value)}\r\n                                            className=\" rounded-lg border-transparent flex-1 appearance-none border border-gray-300 w-full py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent\"\r\n                                            placeholder=\"Enter Password\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            }\r\n                            {newUser &&\r\n\r\n                                <div className=\"mb-2\">\r\n                                    <div className=\" relative \">\r\n                                        <input type=\"password\"\r\n                                            value={repeatPassword}\r\n                                            onChange={(e) => setRepeatPassword(e.target.value)}\r\n                                            className=\" rounded-lg border-transparent flex-1 appearance-none border border-gray-300 w-full py-2 px-4 bg-white text-gray-700 placeholder-gray-400 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent\"\r\n                                            placeholder=\"Confirm Password\"\r\n                                        />\r\n                                    </div>\r\n                                </div>}\r\n                            {!forgotPassword ?\r\n                                <div>\r\n                                    {newUser ? (<div className=\"flex items-center justify-between mt-4\">\r\n                                        <button\r\n                                            className=\"py-2 px-4 text-primary dark:text-secondary bg-secondary dark:bg-primary w-full transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2  rounded-lg \"\r\n                                            onClick={createAccount}\r\n                                        >\r\n                                            Create Account\r\n                                        </button>\r\n                                    </div>)\r\n                                        :\r\n                                        (<div className=\"flex items-center justify-between mt-4\">\r\n                                            <button\r\n                                                className=\"py-2 px-4 text-primary dark:text-secondary bg-secondary dark:bg-primary w-full transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2  rounded-lg \"\r\n                                                onClick={signIn}\r\n                                            >\r\n                                                Log In\r\n                                            </button>\r\n                                        </div>)\r\n                                    }\r\n\r\n\r\n                                    {!newUser ?\r\n                                        <div className=\"flex flex-col justify-between align-end\">\r\n                                            <button\r\n                                                className=\"mt-6 px-4 text-secondary dark:text-primary bg-primary dark:bg-secondary w-full h-auto transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2  rounded-lg \"\r\n                                                onClick={() => setNewUser(true)}\r\n                                            >\r\n                                                Create Account?\r\n                                            </button>\r\n\r\n                                            <label\r\n                                                className=\"mt-6 cursor-pointer text-secondary underline\"\r\n                                                onClick={() => setForgotPassword(true)}\r\n                                            >\r\n                                                Forgot Password?\r\n                                            </label>\r\n                                        </div>\r\n                                        :\r\n                                        <button\r\n                                            className=\"mt-6 px-4 text-secondary dark:text-primary bg-primary dark:bg-secondary w-full h-auto transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2  rounded-lg \"\r\n                                            onClick={() => setNewUser(false)}\r\n                                        >\r\n                                            Already have an account?\r\n                                        </button>\r\n                                    }\r\n                                </div>\r\n                                :\r\n                                <div>\r\n                                    <button\r\n                                        className=\"py-2 px-4 text-primary dark:text-secondary bg-secondary dark:bg-primary w-full transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2  rounded-lg \"\r\n                                        onClick={() => resetPassword(email)}\r\n                                    >\r\n                                        Reset Password\r\n                                    </button>\r\n                                    <button\r\n                                        className=\"mt-6 px-4 text-secondary dark:text-primary bg-primary dark:bg-secondary w-full h-auto transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2  rounded-lg \"\r\n                                        onClick={() => setForgotPassword(false)}\r\n                                    >\r\n                                        Back to Login\r\n                                    </button>\r\n                                </div>\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    )\r\n}"
        }
    ]
}